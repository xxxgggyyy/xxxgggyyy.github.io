---
title: "竞争条件 示例"
date: 2022-07-29T08:13:34+08:00
topics: "cs-basis"
draft: true
---

# 总结

单一指令对单一变量一般来说就是原子的不会出现竞争情况。当然在CISC中某些单条指令其实都包含了同时对内存的读写，这种肯定存在竞争条件。

所以一般来说，除了纯读读的不会产生竞争条件，对于含有读写RAM混杂的临界区都会产生竞争条件。

> 需要具体问题具体分析

# 单一变量
> 考虑两个实体对单一变量的访问和修改
1. 读读没有竞争条件
2. 读写也没有竞争条件
3. **写写**有竞争条件

两个实体同时写入存在丢失更新的可能。

但这和冯诺依曼计算机的基本原则有关系和CPU指令有关系。如果两个实体都是执行单一指令`movl 10, [0]`这种直接用字面量修改内存值的情况，其实也**不存在**竞争条件。但问题在于我们一般使用高级语言并且就程序逻辑需要，都是需要先将内存值取回到CPU，然后将CPU运算后再将运算结果写回。此时出现了经典的丢失更新问题，所以真要较真其实并不是单纯的**写写**存在竞争条件，毕竟要先读。

所以出现竞争条件的其实是读写指令混用的临界区。



所以严格来说应该是：

1. 读 读 -- 无
2. 读 读写 -- 无
3. 读写 读写 -- 存在丢失写
4. 写 读写 -- 存在丢失写
5. 写 读 -- 无
6. 写 写 -- 无

# 多变量（结构体）

1. 读读没有
2. 读写存在
3. 写写存在

> 由于存在多个变量，这里严格来说的情况更多
>
> 所以需要具体问题具体分析

同样这是对于临界区而言的，即存在多条指令

读写，比如为了一致性，修改了一个变量另一个也必须更新，此时读实体可能读出不一致的数据

写写，同上单一变量