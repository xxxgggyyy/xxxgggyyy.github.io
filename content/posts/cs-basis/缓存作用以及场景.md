---
title: "缓存作用以及场景"
date: 2023-04-12T14:32:42+08:00
topics: "cs-basis"
draft: true
---

> 总结一下已知的几种缓存使用场景以及对应的作用

## OS层次内存结构

最先接触的就是这个场景，为了平衡内存位价和性能使用多级内存结构。

cache就是一种缓存，此时的作用比较明显，就是基于局部访问性原理（时间和空间）将内存缓存下来，减少内存访问延迟。

## 计算机网络套接字缓存


套接字的接收或者发送缓存，除了用于实现基于连接的协议的必要性（如TCP的重传要求在确认之前必须缓存起来），一个典型的原因在于缓和不同设备的速率。

更直观一点，其实可能内核网络协议栈每层都有缓存，而有了缓存，每层都不用关心大家发送速率的问题（除了TCP拥塞控制），只要往其缓存里插入（读取）就行了。

> 其他的用于外设的缓存也是类似，比如DMA将数据从外设读入到缓存中

## C标准IO

这里使用缓存的原因在于IO操作的开销大，注意不是因为IO操作耗时，而是IO操作的额外开销大。

典型的比如`write()`操作，其需要陷入内核（该操作开销大），如果有10个字节需要写入，调用10次`write()`每次写入1个字节，与调用一次`write()`一次写入10个字节。假设每次`write()`其低层的数据传输时间都是一样的，但由于调用一次`write()`除了数据传输开销还有其他额外开销，所以10次调用`write()`引入了9次多余的额外开销。

> 所以说这里不是因为IO设备本身慢速的问题，这种问题可以使用DMA来处理
